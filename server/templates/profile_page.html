{% extends 'base_page.html' %}

{% import 'macros.html' as macros %}

{% block stylesheets %}
  <link rel="stylesheet" href="{{ '/static/css/profile_page.css'|version }}">
{% endblock %}

{% set nav_item = "profile" %}

{% block page_title %}
  {{ profile_obj['name'] }}
{% endblock %}

{% block body %}
  <div class="row-fluid">
    <div class="span3">
      <div class="row-fluid personal-info">
        <div class="span12">
          <img height="200" class="profile-pic img-polaroid"
            src="{{ profile_obj['fb_pic_url'] }}?type=large">
            <h1 class="name">{{ profile_obj['name'] }}</h1>
            {% if profile_obj['program_name'] %}
              <p class="lead program">
                {{ profile_obj.get('last_program_year_id', '') }}
                {{ profile_obj['program_name'] }}
              </p>
            {% endif %}
        </div>
      </div>
      <hr class="divider">
      <div class="row-fluid">
        <div class="span12" id="friend-sidebar-container"></div>
      </div>
    </div>
    <div class="span9" id="profile-container">

      {% if own_profile and not has_courses %}
        <h2>Thanks for signing up!</h2>
        <p class="lead">
          If you could just take a moment to <a href="/onboarding">import your
          course history</a> from your Quest transcript, you'll be able to
          rate and share courses you've taken with friends!
        </p>
      {% endif %}

      <div id="exam-schedule-placeholder"></div>
      <div id="term-collection-container"></div>

      {#
      {% if own_profile %}
        <div id="transcript-container">
          <h2>Import Course History</h2>
            <p id="transcript-instructions">
              Copy and paste your
              <a target="_blank"
                href="https://quest.pecs.uwaterloo.ca/psp/SS/?cmd=login">
                transcript from Quest</a>,
              and <strong>your course history will magically appear</strong> here!
            </p>
            <textarea id="transcript-text" placeholder="Feed me a transcript! Mmm... transcripts...." wrap="off"></textarea>
            <p id="transcript-remove-text"></p>
            <div id="transcript-error"></div>
        </div>
        <h3>We value your privacy</h3>
        <p>
          Flow uses your transcript to import your course history and share it
          with friends. <b>We do not store grades or any other private
          information.</b> For more details, check out our privacy
          policy.
        </p>
      {% endif %}
      #}
    </div>
  </div>
{% endblock %}

{% block footer %}
{% endblock %}

{# TODO(david): Have underscore templates specify their deps. #}
{% block templates %}
  {% include 'friend.html' %}
  {% include 'course.html' %}
  {% include 'term.html' %}
  {% include 'ratings.html' %}
  {% include 'user_course.html' %}
  {% include 'exam.html' %}
{% endblock %}

{% block scripts %}
<script>
  window.pageData.transcriptObj = {{ transcript_obj|tojson|safe }};
  window.pageData.userObjs = {{ user_objs|tojson|safe }};
  window.pageData.userCourseObjs = {{ user_course_objs|tojson|safe }};
  window.pageData.professorObjs = {{ professor_objs|tojson|safe }};
  window.pageData.courseObjs = {{ course_objs|tojson|safe }};
  window.pageData.profileUserId = {{ profile_user_id|tojson|safe }};
  window.pageData.ownProfile = {{ own_profile|tojson|safe }};
  window.pageData.examObjs = {{ exam_objs|tojson|safe }};
</script>
{% endblock %}
